<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Understanding Word Embeddings</title>
    <meta charset="utf-8" />
    <meta name="author" content="Julia Silge" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/5235085b15.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="css/footer_plus.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">









layout: true

&lt;div class="my-footer"&gt;&lt;span&gt;bit.ly/silge-byu&lt;/span&gt;&lt;/div&gt; 

---

class: inverse, left, middle

background-image: url(figs/patrick-fore-0gkw_9fy0eQ-unsplash.jpg)
background-size: cover

# Understanding 
# Word 
# Embeddings

.large[Julia Silge | 12 March 2020]

---

class: inverse, left, bottom

background-image: url(figs/patrick-fore-0gkw_9fy0eQ-unsplash.jpg)
background-size: cover

# Find me at...

&lt;a href="http://twitter.com/juliasilge" style="color: white;"&gt;&lt;i class="fa fa-twitter fa-fw"&gt;&lt;/i&gt;&amp;nbsp; @juliasilge&lt;/a&gt;&lt;br&gt;
&lt;a href="http://github.com/juliasilge" style="color: white;"&gt;&lt;i class="fa fa-github fa-fw"&gt;&lt;/i&gt;&amp;nbsp; @juliasilge&lt;/a&gt;&lt;br&gt;
&lt;a href="https://juliasilge.com" style="color: white;"&gt;&lt;i class="fa fa-link fa-fw"&gt;&lt;/i&gt;&amp;nbsp; juliasilge.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://tidytextmining.com" style="color: white;"&gt;&lt;i class="fa fa-book fa-fw"&gt;&lt;/i&gt;&amp;nbsp; tidytextmining.com&lt;/a&gt;&lt;br&gt;
&lt;a href="mailto:julia.silge@gmail.com" style="color: white;"&gt;&lt;i class="fa fa-paper-plane fa-fw"&gt;&lt;/i&gt;&amp;nbsp; julia.silge@gmail.com&lt;/a&gt;

---

class: inverse, center, middle

# ðŸ“‘ TEXT AS DATA ðŸ“Š

---

# Text as data

Let's look at complaints submitted to the [United States Consumer Financial Protection Bureau (CFPB)](https://www.consumerfinance.gov/data-research/consumer-complaints/).


```r
library(tidyverse)

complaints &lt;- read_csv("complaints.csv.gz")
names(complaints)
```

```
## [1] "complaint_id"                 "date_received"                "product"                     
## [4] "issue"                        "company"                      "state"                       
## [7] "consumer_complaint_narrative"
```

---

# Text as data

Let's look at complaints submitted to the [United States Consumer Financial Protection Bureau (CFPB)](https://www.consumerfinance.gov/data-research/consumer-complaints/).


```r
complaints %&gt;%
  sample_n(7) %&gt;%
  pull(consumer_complaint_narrative)
```

```
## [1] "Old National Bank advertised a {$200.00} promotional checking bonus offer online and in branch. I opened a checking account with them based on this offer and completed all of the listed terns and conditions of the offer but Old National Bank did not add the {$200.00} bonus to my account after I did so. I have attached copies of the details of the promotional offer that I received in branch and the business card of the banker that opened my account, screenshots of the same offer that were advertised on Old National Bank 's website ( this offer was subsequently extended until XX/XX/XXXX ), and copies of my monthly Old National Bank checking account statements for reference. \n\nA summary of the listed terms and conditions of the {$200.00} promotional checking bonus offer and how I fulfilled them are detailed below : 1. Open a new ONB Everyday, ONB Preferred, or ONB Classic checking account. \n\nI opened a new ONB Everyday checking account. \n\n2. Open the new account by visiting a branch located in XXXX, IN, XXXX, MI, XXXX, KY, the XXXX XXXX of XXXX, XXXX, XXXX XXXX, or XXXX, or in the XXXX XXXX of XXXX. \n\nI opened the new account in the XXXX, IN branch located at XXXX XXXX XXXX XXXX, Indiana, XXXX in XXXX XXXX XXXX. \n\n3. Open the new account by XX/XX/XXXX ( later extended to XX/XX/XXXX ). \n\nI opened the new account on XX/XX/XXXX. \n\n4. Open the new account with a minimum opening deposit of {$50.00}. \n\nI opened the new account with an opening deposit of {$50.00}. \n\n5. Offer is not available for Old National associates or clients with an existing Old National checking account or checking accounts closed in the past 6 months. \n\nI am not an Old National associate. I did have another Old National checking account that was closed on XX/XX/XXXX, which was more than 6 months before I opened the new account on XX/XX/XXXX. \n\n6. The {$200.00} bonus will be deposited into the new checking account after receiving automatic direct deposits totaling {$500.00} or more within 75 days of account opening. \n\nI received a direct deposit of {$510.00} from XXXX XXXX on XX/XX/XXXX. \n\n7. The {$200.00} bonus will be deposited into the new checking account after receiving 10 Old National debit card transactions of {$10.00} or more within 75 days of account opening. \n\nI made 10 purchases on my Old National debit card of {$10.00} each with XXXX between XX/XX/XXXX and XX/XX/XXXX. \n\n8. The account must be open and in good standing at the time the incentive is paid. \n\nMy account is open and in good standing. \n\n9. Limit one bonus per calendar year, one per account and one per individual. \n\nI received a bonus on XX/XX/XXXX on a different checking account. This {$200.00} promotional incentive bonus became payable when I completed all of the listed terms and conditions of the advertised offer on XX/XX/XXXX, which is in a new calendar year and on a new checking account and therefore valid. The terms stating that bonuses are limited to one per calendar year means that it is possible for an individual to receive a bonus each calendar year. If the bank had intended to mean that bonuses are limited to once per lifetime of an individual, they would not have included the phrase \" one ... per calendar year ''."
## [2] "Per the attached letter, I have been contacting Equifax by mail, phone, and online to remove a consumer statement- to no avail. I even tried to have it change to no avail. I simply want the consumer statement removed."                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
## [3] "As of XX/XX/2004 the company XXXX XXXX XXXX ( for XXXX University ) has been trying to collect this debt. I had asked for info, got the information. Since then they have signed me up saying i owe them for a course through their university. I have never received any books, test or even taken any course from their university. I have repeatedly sent letters to collection companies saying I do not owe this and have reported them to the credit bureau. This has been going on for 14 years and I am tired of this. It needs to stop."                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
## [4] "The following accounts were opened up fraudulently and I'm demanding the immediate removal of these unauthorized and unknown accounts, please remove and block the following 1. XXXX   {$4700.00} 2. XXXX XXXX {$0.00} 3. XXXX XXXX {$560.00}"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
## [5] "This problem started with a XXXX timeshare purchased by my ex in 2005. He supposedly gave it to me as a gift so I was tricked into signing the contract. I subsequently found out it is a timeshare trick because his credit record was so bad he would n't qualify for a loan. As a result, XXXX put the whole thing under my name only without my knowledge. Because of XXXX I never got any documentation. XXXX apparently sent all correspondence to him. He vowed to bankrupt me and ruin my credit. Even though there is a court order stating he had to tell me if there was a XXXX issued he never did. This year a repo showed up on equifax from XXXX who apparently bought XXXX. They refused to acknowledge that. Ever received notice, and refused to honor the divorce decree showing it as a joint debt. After many calls I got the contract cancelled. However, They say I owe a balance and nothing went on his credit report. 1 ) is n't there any protection in XXXX situations? 2 XXXX how can you repo time? Does n't there have to be real property? 3 ) how can it show as a repo and a balance due on my credit report? Is n't it one or the other? 4 XXXX why is n't he being held responsible for the debt? \n\nThis is keeping me from getting any loans 8 years after it occurred. They strong armed me into paying {$1400.00} to clear the repo from my credit report and after I sent the check they said it does n't guarantee they will remove the repo. \n\nHelp me get free from my ex XXXX and XXXX!!!!"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
## [6] "Equifax was hacked and my information was compromised in the incident. I now have more reason to fear identity theft may be in the future."                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
## [7] "I called XXXX XXXX XXXX to get service, i was told it would be a soft inquiry to get the service. Not only that, but I was signed up for the entirely wrong product, i have been calling XXXX XXXX XXXX and no one can find my account number to offer me any help. After calling over 25 times, stepping in to a brick and mortar store they did let me know that i was NOT signed up for the service i requested, instead the CSR i dealt with that night signed me up for whatever he wanted to sign me up for. They have told me since to refuse the package that was sent to my property which i have already done. The XXXX router which apparently that CSR signed me up for apparently is still activated which the brick and mortar XXXX XXXX XXXX store told me and they have no idea why it's still activated but it should have been already canceled. No one has been able to help me regarding the 2 inquiries i now have on my Equifax report from XXXX and XXXX XXXX XXXX even after i was signed up for the wrong product, and returned whatever product they sent in the package. I don't have any luck getting anyone to help me with this on the phone or inside a store. They did not spell my name correctly on the paperwork, let alone my email. They have supplied me with a link to put in my information for wrong inquiries placed on reports but it has been weeks with no answer, i need help on getting this resolved from the corresponding forces."
```

---

# Text as data

What is a typical way to represent this text data for modeling?


```r
library(tidytext)
library(SnowballC)

complaints %&gt;% 
  unnest_tokens(word, consumer_complaint_narrative) %&gt;% 
  anti_join(get_stopwords()) %&gt;%  
  mutate(stem = wordStem(word)) %&gt;% 
  count(complaint_id, stem) %&gt;%  
  bind_tf_idf(stem, complaint_id, n) %&gt;% 
  cast_dfm(complaint_id, stem, tf_idf)
```

```
## Document-feature matrix of: 500,658 documents, 125,186 features (100.0% sparse).
##          features
## docs         acknowledg     actual       addit     balanc     bureau       case    compani   complaint
##   1290155 NA 0.04418805 0.03477452 0.030261114 0.02217244 0.04520857 0.02941591 0.01419504 0.023488768
##   1290157  0 0          0          0           0          0          0          0          0          
##   1290181  0 0          0          0           0          0          0          0          0          
##   1290198  0 0          0          0.007275896 0.03198648 0          0          0          0.005647573
##   1290200 NA 0.03381346 0          0           0          0          0          0.01086229 0          
##   1290238  0 0          0          0           0          0          0          0          0          
##          features
## docs         confirm
##   1290155 0.06119605
##   1290157 0         
##   1290181 0         
##   1290198 0         
##   1290200 0         
##   1290238 0         
## [ reached max_ndoc ... 500,652 more documents, reached max_nfeat ... 125,176 more features ]
```


---

class: inverse, left, bottom

background-image: url(figs/patrick-fore-0gkw_9fy0eQ-unsplash.jpg)
background-size: cover

# This representation...

- is incredibly sparse
- of high dimensionality
- with a huge number of features

---

class: inverse, center, middle

# ðŸ“„ WORD EMBEDDINGS ðŸ“”

---

class: right, middle

&lt;h1 class="fa fa-quote-left fa-fw"&gt;&lt;/h1&gt;

&lt;h1&gt; You shall know a word by the company it keeps. &lt;/h1&gt;

&lt;h1 class="fa fa-quote-right fa-fw"&gt;&lt;/h1&gt;

.large[John Rupert Firth]

---

class: inverse

# Modern word embeddings

--

- word2vec

--

- GloVe

--

- fastText

--

- language models with transformers like ULMFiT

---

class: inverse, left, bottom

background-image: url(figs/patrick-fore-0gkw_9fy0eQ-unsplash.jpg)
background-size: cover

# We can determind word embedding using...

- word counts
- matrix factorization

---

class: inverse, left, bottom

background-image: url(figs/patrick-fore-0gkw_9fy0eQ-unsplash.jpg)
background-size: cover


# Thanks!

&lt;a href="http://twitter.com/juliasilge" style="color: white;"&gt;&lt;i class="fa fa-twitter fa-fw"&gt;&lt;/i&gt;&amp;nbsp; @juliasilge&lt;/a&gt;&lt;br&gt;
&lt;a href="http://github.com/juliasilge" style="color: white;"&gt;&lt;i class="fa fa-github fa-fw"&gt;&lt;/i&gt;&amp;nbsp; @juliasilge&lt;/a&gt;&lt;br&gt;
&lt;a href="https://juliasilge.com" style="color: white;"&gt;&lt;i class="fa fa-link fa-fw"&gt;&lt;/i&gt;&amp;nbsp; juliasilge.com&lt;/a&gt;&lt;br&gt;
&lt;a href="https://tidytextmining.com" style="color: white;"&gt;&lt;i class="fa fa-book fa-fw"&gt;&lt;/i&gt;&amp;nbsp; tidytextmining.com&lt;/a&gt;&lt;br&gt;
&lt;a href="mailto:julia.silge@gmail.com" style="color: white;"&gt;&lt;i class="fa fa-paper-plane fa-fw"&gt;&lt;/i&gt;&amp;nbsp; julia.silge@gmail.com&lt;/a&gt;

Slides created with &lt;a href="http://remarkjs.com/" style="color: #5A6B8C;"&gt;&lt;b&gt;remark.js&lt;/b&gt;&lt;/a&gt; and &lt;a href="https://github.com/yihui/xaringan" style="color: #5A6B8C;"&gt;&lt;b&gt;xaringan&lt;/b&gt;&lt;/a&gt;

Photo by &lt;a href="https://unsplash.com/@patrickian4?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" style="color: #5A6B8C;"&gt;&lt;b&gt;Patrick Fore&lt;/b&gt;&lt;/a&gt; on &lt;a href="https://unsplash.com/s/photos/letters?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" style="color: #5A6B8C;"&gt;&lt;b&gt;Unsplash&lt;/b&gt;&lt;/a&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
